<!DOCTYPE html>

<html>
    <head>
        <!--
        Customize this policy to fit your own app's needs. For more guidance, see:
            https://github.com/apache/cordova-plugin-whitelist/blob/master/README.md#content-security-policy
        Some notes:
            * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
            * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
            * Disables use of inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
                * Enable inline JS: add 'unsafe-inline' to default-src
        -->
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <title>A Pp (lick a shun)</title>
    </head>
    <body>
        <div id="edit" class="editor" contenteditable>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script>
        <script type="text/javascript" src="js/editable.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script>
            "use strict";

            var index = elasticlunr(function () {
                this.addField('n'); //label
                this.addField('S'); //list of supercategories
                this.addField('s'); //list of subcategories
                this.setRef('i'); //URI
            });

            $.get('cat.json', (x)=>{
              //console.log(x);
              //console.log('categories', x);
              console.log('loading categories...');
              var count = 0;
              for(var i in x) {
                const item = x[i];
                item.i = i;
                index.addDoc(item);
                count++;
              }
              console.log(count, 'categories loaded.');

            });

            var ee = document.getElementById('edit');

/*
https://garann.github.io/contenteditable/slides/contenteditable.html#/23
command IDs (W3C)

    bold
    createLink
    delete
    formatBlock
    forwardDelete
    insertHTML
    insertImage
    insertLineBreak
    insertOrderedList
    insertUnorderedList

    insertParagraph
    insertText
    italic
    redo
    selectAll
    subscript
    superscript
    undo
    unlink
    unselect

*/
            var editable = new Editable({
              defaultBehavior: true
            });

            editable.add(ee);

            editable.on('change', elem => {
              const currentContent = editable.getContent(elem);
            });
            editable.on('split', (elem, before, after, cursor) => {
                // before and after are document fragments with the content
                  // from before and after the cursor in it.
                  console.log('split', elem);
            });

            editable.on('switch', (elem, direction, cursor) => {
              console.log(direction);
              if (direction === 'after') {
                // your code...
              } else if (direction === 'before') {
                // your code...
              }
            });
        </script>
    </body>

</html>
